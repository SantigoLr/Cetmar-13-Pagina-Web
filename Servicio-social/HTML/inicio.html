<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Inicio</title>
</head>
<body>
  <h1 id="bienvenida">Cargando...</h1>
  <script>
    const usuario = JSON.parse(localStorage.getItem('usuario'));
    if (usuario) {
      document.getElementById('bienvenida').textContent = `Bienvenido, ${usuario.nombre} (${usuario.rol})`;
    } else {
      window.location.href = '/HTML/Login.html'; // Evita entrar sin login
    }
  </script>

  <form id="form-subir-noticia">
    <input type="text" name="titulo" placeholder="TÃ­tulo" required>
    <textarea name="contenido" placeholder="Contenido" required></textarea>
    <input type="text" name="imagen_url" placeholder="URL de imagen">
    <button type="submit">Subir Noticia</button>
  </form>


<script>
  document.getElementById('form-subir-noticia').addEventListener('submit', async (e) => {
    e.preventDefault();

    const noticia = {
      titulo: e.target.titulo.value,
      texto: e.target.contenido.value,    // cambiar contenido a texto
      imagen_url: e.target.imagen_url.value
    };

    const res = await fetch('/noticias/subir', { // URL relativa, mismo servidor y puerto
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify(noticia)
    });

    const data = await res.json();
    alert(data.mensaje);
  });
</script>

</body>
</html>